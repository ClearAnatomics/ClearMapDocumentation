
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Menu Alignment &#8212; ClearMap 2.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=819c53c9" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=32e37178"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gui/menu_alignment';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Menu CellMap" href="menu_cell_map.html" />
    <link rel="prev" title="Menu Sample" href="menu_sample.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">ClearMap 2.1.0</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../functionality.html">
    Functionality
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    GUI usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../advanced/advanced_usage.html">
    ClearMap pipelines
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../media.html">
    News and Media
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../references.html">
    References
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ChristophKirst/ClearMap2" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/clearmap_idisco" title="X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-square-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">X</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../functionality.html">
    Functionality
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    GUI usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../advanced/advanced_usage.html">
    ClearMap pipelines
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../media.html">
    News and Media
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../references.html">
    References
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ChristophKirst/ClearMap2" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/clearmap_idisco" title="X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-square-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">X</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="menu_sample.html">Menu Sample</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Menu Alignment</a></li>

<li class="toctree-l1"><a class="reference internal" href="menu_cell_map.html">Menu CellMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="menu_vasculature.html">Menu Vasculature</a></li>
<li class="toctree-l1"><a class="reference internal" href="menu_batch.html">Menu Batch</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">GUI usage</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Menu Alignment</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="menu-alignment">
<h1>Menu Alignment<a class="headerlink" href="#menu-alignment" title="Link to this heading">#</a></h1>
<figure class="align-left">
<img alt="../_images/alignment_tab.png" src="../_images/alignment_tab.png" />
</figure>
<p>You can now proceed to the alignment (stitching of the tiles and atlas
registration)</p>
<p>The stitching is done in two steps. A first alignment is performed where
the software tries to find the best overlap of the entire columns of
data tiles. This mode is called <em>Rigid stitching</em>. After this step, some
further optimisation is applied where the different image planes of the
column are allowed to slightly shift relative to each other. This is
called <em>Wobbly stitching</em>.</p>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<section id="stitching-rigid-tab">
<h2>Stitching → Rigid tab<a class="headerlink" href="#stitching-rigid-tab" title="Link to this heading">#</a></h2>
<figure class="align-left">
<img alt="../_images/stitching_rigid_top.png" src="../_images/stitching_rigid_top.png" />
</figure>
<dl class="simple">
<dt>X overlap</dt><dd><p>Expected overlap between tiles along X dimension (in pixels).
This is a few percent of the tile dimension in pixels and
depends on the microscope.</p>
</dd>
<dt>Y overlap</dt><dd><p>Expected overlap between tiles along Y dimension (in pixels)
This is a few percent of the tile dimension in pixels and depends on
the microscope.</p>
</dd>
</dl>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<dl>
<dt>Projection thickness</dt><dd><p>Number of planes to average to compute the optimum overlap between X
and Y dimensions</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>A bit more than the overlap you set for x and y.</p>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Correct these values if you see a systematic problem in the
alignment after the stitching.</p>
</div>
<a class="reference internal image-reference" href="../_images/stitching_overlay_preview.png"><img alt="../_images/stitching_overlay_preview.png" class="align-right" src="../_images/stitching_overlay_preview.png" style="width: 450px;" />
</a>
<p>You can get an idea of the overlap by clicking the preview overlap button which will display a
<em>pre-stitched</em> image stitched only based on a fixed overlap with chessboard colors for adjacent tiles.
This is not the same as the stitched image because the overlap has not been optimised, hence why the grid appears.</p>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<figure class="align-left">
<img alt="../_images/stitching_rigid_bottom.png" src="../_images/stitching_rigid_bottom.png" />
</figure>
<dl class="simple">
<dt>Shifts:</dt><dd><p>Maximum shift (in pixels) from the expected overlap allowed in
either direction along a given axis to optimise the alignment
(correlograms)</p>
</dd>
</dl>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<dl class="simple">
<dt>Background level</dt><dd><p><em>Ignore pixels below this value for stitching: e.g.</em>
~400. This value is ideally the same for all the samples but you may
need to play with it in order to get the best stitching you can.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This value is used only to compute the optimal overlap for
stitching and does not affect your cell detection.</p>
</div>
<dl class="simple">
<dt>Background pixels</dt><dd><p><em>Number of pixels that need to be above this value to
be considered.</em></p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To check these values, click on <strong>Preview levels</strong> and look at the values (visible at the bottom of the window)
for cells, background and outside of the brain.</p>
<a class="reference internal image-reference" href="../_images/stitching_intensity_preview.png"><img alt="../_images/stitching_intensity_preview.png" class="align-center" src="../_images/stitching_intensity_preview.png" style="width: 400px;" />
</a>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This is only a quick preview of the stitching, which is why the stitching grid is visible.</p>
</div>
</div>
</section>
<section id="stitching-wobbly-tab">
<h2>Stitching → Wobbly tab<a class="headerlink" href="#stitching-wobbly-tab" title="Link to this heading">#</a></h2>
<img alt="../_images/stitching_wobbly.png" class="align-left" src="../_images/stitching_wobbly.png" />
<p>Correction for the wobbly movements from the stage of the microscope
when you move in z. It is a mechanical shift. Values have to be
optimized for each microscope.</p>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<dl class="simple">
<dt>Max shifts Z:</dt><dd><p>Usually stays 0.</p>
</dd>
<dt>Ranges</dt><dd><p>signal range. :FIXME:</p>
</dd>
<dt>Slice pixel size:</dt><dd><p>Usually not necessary</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Correct these values if you see a one-off problem in the alignment after the stitching.</p>
</div>
</section>
<section id="stitching-run-stitching-tab">
<h2>Stitching → Run stitching tab<a class="headerlink" href="#stitching-run-stitching-tab" title="Link to this heading">#</a></h2>
<figure class="align-left">
<img alt="../_images/stitching_run.png" src="../_images/stitching_run.png" />
</figure>
<p>Once the values have been selected, you can proceed to the stitching.</p>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<p>As mentioned above, using the tiles previously converted to .npy can
speed stitching but is not required. You can tick this if you chose to
convert the tiles in the previous step.</p>
<p>For CellMap, you should just need to tick “Main channel”. Once done,
click <strong>Run</strong></p>
<p>If you want to ensure that the stitching is being performed as expected,
you can look at the CPU bar in the bottom right corner of the interface
to see that resources are being used.</p>
</section>
<section id="stitching-display-results-tab">
<h2>Stitching → Display results tab<a class="headerlink" href="#stitching-display-results-tab" title="Link to this heading">#</a></h2>
<p>For CellMap, tick <em>Main channel</em>. For TubeMap, you will also likely want
to look at the <em>secondary channel</em>.</p>
</section>
<section id="plot">
<h2>Plot<a class="headerlink" href="#plot" title="Link to this heading">#</a></h2>
<p>Check your results</p>
<figure class="align-left">
<img alt="../_images/stitching_display.png" src="../_images/stitching_display.png" />
</figure>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<p>If you have some tiles completely back you should adjust your background
level and restart the stitching before moving forward.</p>
<figure class="align-left">
<a class="reference internal image-reference" href="../_images/stitching_display_example.png"><img alt="../_images/stitching_display_example.png" src="../_images/stitching_display_example.png" style="width: 400px;" />
</a>
</figure>
<p>In the DataViewer sub-window, there is a small vertical bar below the
title which you can drag to change the layer to display. Alternatively,
you can scroll with the mouse wheel when hovering the title. Scrolling
on the image itself zooms.</p>
<p>Change the brightness/contrast and LUT with the controls on the right.</p>
<p>Right click <strong>view all</strong> to reset the view</p>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
</section>
<section id="stitching-output-conversion-tab">
<h2>Stitching → Output conversion tab<a class="headerlink" href="#stitching-output-conversion-tab" title="Link to this heading">#</a></h2>
<p>If you want to save your image in another format (e.g. to visualise them
in FIJI), select the channel, the output format and use the <strong>convert</strong>
button. This will output your files in the selected format in the same
folder.</p>
<figure class="align-left">
<img alt="../_images/stitching_output_conversion.png" src="../_images/stitching_output_conversion.png" />
</figure>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
</section>
</section>
<section id="atlas-registration-atlas-settings-tab">
<h1>Atlas registration → Atlas settings tab<a class="headerlink" href="#atlas-registration-atlas-settings-tab" title="Link to this heading">#</a></h1>
<figure class="align-left">
<img alt="../_images/registration_atlas_settings.png" src="../_images/registration_atlas_settings.png" />
</figure>
<p>To segment your data, i.e. assign a brain region to detected cells, you
will need to align an atlas to your sample. This is done by aligning a
reference image onto which an atlas was drawn and which was acquired
with the same modality as your sample to a dedicated channel of your
brain which contains only background information and no specific data.
This channel is the <em>autofluorescence</em> channel. Because this channel is
not acquired concomitantly to your data channels in light sheet
microscopy, you will also need to align your autofluorescence channel to
your data channel. Since both images come from the same sample, this
second step is usually much simpler and only requires <em>rigid</em>
registration, which is a combination of rotation, translation, scaling
and shearing. On the contrary, the <em>reference</em> to <em>autofluorescence</em>
alignment can be more challenging and uses a step of rigid registration
followed by a step of <em>elastic</em> registration which involves local
deformations of the sample.</p>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<p><strong>Atlas: ABA 2017 – adult mouse – 25 um</strong></p>
<p><strong>Atlas resolution: 25 25 25</strong></p>
<p><strong>Structure tree: ABA json 2022</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In future releases, these will become the defaults for the
atlas so you won’t have to select them.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to make these your defaults. You can do so by changing
the value in the <em>$HOME/.clearmap/default_alignment_params.cfg</em>
file in the relevant section.</p>
</div>
</div>
<section id="atlas-registration-run-registration-tab">
<h2>Atlas registration → Run registration tab<a class="headerlink" href="#atlas-registration-run-registration-tab" title="Link to this heading">#</a></h2>
<figure class="align-left">
<img alt="../_images/registration_run.png" src="../_images/registration_run.png" />
</figure>
<p>Usually. If the <strong>sample</strong> -&gt; <strong>atlas space info</strong> parameters were
defined correctly, it should suffice to click <strong>run</strong>. You can then
verify the alignment in the next tab (see below).</p>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<figure class="align-left">
<a class="reference internal image-reference" href="../_images/registration_landmarks.png"><img alt="../_images/registration_landmarks.png" src="../_images/registration_landmarks.png" style="width: 600px;" />
</a>
</figure>
<p>Should the alignment not be satisfactory, you could then select <strong>Use
reference landmarks</strong>. A new dialog will appear together with the two
images you are trying to align plotted side by side. You should click a
feature on the left image that you can also easily pinpoint in the right
image and the select <em>add marker</em> to create a new marker and repeat the
operation. The number of markers required depends on the difficulty of
alignment. For simple alignment mistakes, a handful of markers should
suffice. However, this method was successfully used to align whole head
MRI scans to LSM brain scans.</p>
<p>In the very unlikely event that the autofluorescence to raw data
alignment is not correct, you could do the same with the <strong>Use resampled
landmarks.</strong></p>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
</section>
<section id="atlas-registration-display-results-tab">
<h2>Atlas registration → Display results tab<a class="headerlink" href="#atlas-registration-display-results-tab" title="Link to this heading">#</a></h2>
<figure class="align-left">
<img alt="../_images/registration_display_controls.png" src="../_images/registration_display_controls.png" />
</figure>
<p>You can now display the result of the 2 different alignments discussed
above in 2 different ways. Either as an overlay with 2 different colors
or side by side with a matching crosshair.</p>
<p>Before proceeding with the analysis you should ensure that the
alignments are correct, especially the more troublesome <strong>Reference to
autofluorescence</strong>.</p>
<div class="clearer docutils container">
<img alt="../_images/clearer.png" src="../_images/clearer.png" />
</div>
<figure class="align-default" id="id1">
<img alt="../_images/registration_overlay.png" src="../_images/registration_overlay.png" />
<figcaption>
<p><span class="caption-number">Figure 1 </span><span class="caption-text">Plot auto to raw composite</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id2">
<img alt="../_images/registration_side_by_side.png" src="../_images/registration_side_by_side.png" />
<figcaption>
<p><span class="caption-number">Figure 2 </span><span class="caption-text">Plot ref to auto side by side</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="menu_sample.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Menu Sample</p>
      </div>
    </a>
    <a class="right-next"
       href="menu_cell_map.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Menu CellMap</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Menu Alignment</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stitching-rigid-tab">Stitching → Rigid tab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stitching-wobbly-tab">Stitching → Wobbly tab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stitching-run-stitching-tab">Stitching → Run stitching tab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stitching-display-results-tab">Stitching → Display results tab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot">Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stitching-output-conversion-tab">Stitching → Output conversion tab</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#atlas-registration-atlas-settings-tab">Atlas registration → Atlas settings tab</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#atlas-registration-run-registration-tab">Atlas registration → Run registration tab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#atlas-registration-display-results-tab">Atlas registration → Display results tab</a></li>
</ul>
</li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/gui/menu_alignment.rst">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Copyright © 2020 by Christoph Kirst.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>